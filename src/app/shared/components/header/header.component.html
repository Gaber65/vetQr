<header *ngIf="isAuthenticated">
  <nav>
    <a routerLink="/dashboard" class="brand">
      <!-- <img src="assets/logo.png" alt="Logo"> -->
      <span>QuadInsight.QR</span>
      <span class="version-badge">v{{ appVersion }}</span>
    </a>

    <div class="nav-links" [class.active]="isMenuOpen">
      <!-- Dashboard Link (Common for all) -->
      <a 
        routerLink="/dashboard" 
        routerLinkActive="active"
        [routerLinkActiveOptions]="{ exact: true }"
      >
        <mat-icon>dashboard</mat-icon>
        {{ "HEADER.DASHBOARD" | translate }}
      </a>

      <!-- Super Admin Links -->
      <ng-container *ngIf="isSuperAdmin">
        <a
          routerLink="/super-admin"
          routerLinkActive="active"
          [routerLinkActiveOptions]="{ exact: true }"
        >
          <mat-icon>admin_panel_settings</mat-icon>
          {{ "HEADER.SUPER_ADMIN" | translate }}
        </a>
        <a routerLink="/super-admin/create-clinic" routerLinkActive="active">
          <mat-icon>add_business</mat-icon>
          {{ "HEADER.CREATE_CLINIC" | translate }}
        </a>
         <a routerLink="/super-admin/create-clinic" routerLinkActive="active">
          <mat-icon>add_business</mat-icon>
          {{ "HEADER.CREATE_CLINIC" | translate }}
        </a>
      </ng-container>

      <!-- Admin Links -->
      <ng-container *ngIf="isAdmin">
        <a routerLink="/admin" routerLinkActive="active">
          <mat-icon>settings</mat-icon>
          {{ "HEADER.ADMIN" | translate }}
        </a>
        <a routerLink="/admin/users" routerLinkActive="active">
          <mat-icon>people</mat-icon>
          {{ "HEADER.USERS" | translate }}
        </a>
      </ng-container>

      <!-- User Links -->
      <ng-container *ngIf="isUser">
        <a routerLink="/user/pets" routerLinkActive="active">
          <mat-icon>pets</mat-icon>
          {{ "HEADER.PETS" | translate }}
        </a>
        <a routerLink="/user/appointments" routerLinkActive="active">
          <mat-icon>event</mat-icon>
          {{ "HEADER.APPOINTMENTS" | translate }}
        </a>
      </ng-container>
    </div>

    <div class="user-actions">
      <!-- Language Switcher -->
      <div class="lang-switcher">
        <button
          [class.active]="currentLang === 'en'"
          (click)="switchLanguage('en')"
          matTooltip="{{ 'HEADER.ENGLISH' | translate }}"
        >
          EN
        </button>
        <span>|</span>
        <button
          [class.active]="currentLang === 'ar'"
          (click)="switchLanguage('ar')"
          matTooltip="{{ 'HEADER.ARABIC' | translate }}"
        >
          AR
        </button>
      </div>

      <!-- User Profile with Dropdown -->
      <div class="profile-dropdown">
        <button class="profile-trigger" (click)="toggleDropdown()">
          <div class="avatar">
            {{ userInitials }}
          </div>
          <div class="info">
            <span class="name">{{ userName | translate }}</span>
            <span class="role">{{ "HEADER.ROLE_" + userRole.toUpperCase().replace(' ', '_') | translate }}</span>
          </div>
          <mat-icon class="dropdown-icon" [class.open]="isDropdownOpen">
            {{ isDropdownOpen ? 'expand_less' : 'expand_more' }}
          </mat-icon>
        </button>

        <!-- Dropdown Menu -->
        <div class="dropdown-menu" [class.open]="isDropdownOpen" (click)="$event.stopPropagation()">
          <div class="dropdown-header">
            <div class="avatar-large">
              {{ userInitials }}
            </div>
            <div class="user-details">
              <h4>{{ userName }}</h4>
              <p class="role-text">{{ "HEADER.ROLE_" + userRole.toUpperCase().replace(' ', '_') | translate }}</p>
            </div>
          </div>
          
          <div class="dropdown-divider"></div>
          
          <div class="dropdown-items">
            <button class="dropdown-item" (click)="navigateToProfile()">
              <mat-icon>person</mat-icon>
              <span>{{ "HEADER.PROFILE" | translate }}</span>
            </button>
            
            <button class="dropdown-item" (click)="navigateToSettings()">
              <mat-icon>settings</mat-icon>
              <span>{{ "HEADER.SETTINGS" | translate }}</span>
            </button>
            
            <div class="dropdown-divider"></div>
            
            <button class="dropdown-item logout-item" (click)="logout()">
              <mat-icon>logout</mat-icon>
              <span>{{ "HEADER.LOGOUT" | translate }}</span>
            </button>
          </div>
        </div>
      </div>
    </div>

    <button class="mobile-toggle" (click)="toggleMenu()">
      <mat-icon>{{ isMenuOpen ? 'close' : 'menu' }}</mat-icon>
    </button>
  </nav>
  
  <!-- Backdrop for dropdown -->
  <div class="dropdown-backdrop" 
       *ngIf="isDropdownOpen" 
       (click)="closeDropdown()">
  </div>
</header>
